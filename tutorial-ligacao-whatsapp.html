<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Liga√ß√£o WhatsApp</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/style-whatsapp.css">
</head>
<body>

    <div class="app-container">
        <div class="tutorial-screen whatsapp-bg">
            
            <!-- TELA 1: LISTA DE CONVERSAS --><div class="chat-list-screen" id="chat-list-screen">
                 <header class="tutorial-header">
                    <!-- Bot√£o voltar para o menu-whatsapp --><a href="menu-whatsapp.html">‚Üê</a>
                    <h4>Conversas</h4>
                </header>
                <div class="whatsapp-chat-list">
                    <div class="chat-item" id="target-contato">
                        <img src="images/perfil.png" alt="Foto">
                        <div class="chat-info">
                            <h4>Maria (filha)</h4>
                            <p>Clique aqui para ligar!</p>
                        </div>
                    </div>
                    <div class="chat-item">
                        <img src="images/perfil.png" alt="Foto">
                        <div class="chat-info">
                            <h4>Grupo da fam√≠lia</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TELA 2: TELA DE CONVERSA --><div class="chat-screen" id="chat-screen">
                 <header class="tutorial-header" style="background-color: #075E54;">
                    <a href="#" id="back-button" style="font-size: 1.5em;">‚Üê</a>
                    <img src="images/perfil.png" alt="Foto" style="width:40px; height:40px; border-radius: 50%; margin-right: 10px;">
                    <h4 style="margin:0; flex-grow: 1;">Maria (filha)</h4>
                    
                    <!-- √çCONES DE LIGA√á√ÉO E TR√äS PONTOS - AGORA S√ÉO IMAGENS --><div class="chat-header-icons">
                        <button class="header-icon-button" id="target-call-button">
                            <img src="images/telefone.png" alt="√çcone de Liga√ß√£o" style="width: 30px;">
                        </button>
                        <button class="header-icon-button">
                            <img src="images/3pontos.png" alt="√çcone de mais op√ß√µes">
                        </button>
                    </div>
                </header>
                <!-- Apenas para preencher espa√ßo, o usu√°rio n√£o vai interagir aqui --><div class="chat-history" id="chat-history"></div>
                <div class="chat-input-bar">
                    <input type="text" class="chat-input" placeholder="Digite uma mensagem" readonly>
                    <button class="send-button" style="opacity: 0.5;">‚û§</button>
                </div>
            </div>

            <!-- TELA 3: TELA DE LIGA√á√ÉO --><div class="call-screen" id="call-screen">
                <div class="call-info">
                    <img src="images/perfil.png" alt="Foto de perfil">
                    <h2>Maria (filha)</h2>
                    <p id="call-status">Chamando...</p>
                </div>
                <div class="call-actions">
                    <button class="end-call-button" id="target-end-call-button">
                        <!-- √çCONE DE TELEFONE DIMINU√çDO DE 40px PARA 30px -->
                        <img src="images/telefone.png" alt="√çcone de Telefone" style="width: 30px; height: 30px; filter: invert(100%) rotate(-135deg);">
                    </button>
                </div>
            </div>

            <!-- POPUPS DE AJUDA --><div class="help-popup" id="popup-1" style="top: 150px; display: block;">
                <span class="popup-close">X</span>
                <p>Bem-vindo ao treino de liga√ß√£o! üìû</p>
                <p>Primeiro, <b>clique no contato</b> para quem voc√™ quer ligar. Vamos tentar a <b>"Maria (Filha)"</b>.</p>
            </div>

            <div class="help-popup" id="popup-2" style="top: 150px;">
                <span class="popup-close">X</span>
                <p>√ìtimo! Esta √© a tela de conversa.</p>
                <p>Para fazer uma liga√ß√£o, <b>clique no √≠cone de telefone</b> no canto superior direito.</p>
            </div>

            <div class="help-popup" id="popup-3" style="top: 50%; transform: translate(-50%, -50%);">
                <span class="popup-close">X</span>
                <p>Perfeito! A liga√ß√£o est√° come√ßando.</p>
                <p>Voc√™ ver√° "Chamando..." e, quando a pessoa atender, o tempo come√ßar√° a contar.</p>
                <button onclick="proximaEtapa('popup-4')">Entendi!</button>
            </div>

            <div class="help-popup" id="popup-4" style="bottom: 180px; top: auto;">
                <span class="popup-close">X</span>
                <p>A chamada est√° em andamento!</p>
                <p>Para desligar, <b>clique no bot√£o vermelho</b> na parte de baixo.</p>
            </div>

            <div class="help-popup" id="popup-5" style="top: 30%;">
                <span class="popup-close">X</span>
                <p>Tutorial conclu√≠do! ‚úÖ</p>
                <p>Voc√™ aprendeu a fazer e a desligar uma chamada. Muito bem!</p>
                <button onclick="window.location.href='menu-whatsapp.html'">Voltar ao Menu</button>
            </div>

        </div>
    </div>

    <script>
        // --- Pegando todos os elementos ---
        const chatListScreen = document.getElementById('chat-list-screen');
        const chatScreen = document.getElementById('chat-screen');
        const callScreen = document.getElementById('call-screen'); 
        const targetContato = document.getElementById('target-contato');
        const targetCallButton = document.getElementById('target-call-button');
        const targetEndCallButton = document.getElementById('target-end-call-button');
        const backButton = document.getElementById('back-button');
        const callStatus = document.getElementById('call-status');

        // --- Fun√ß√£o Helper: Controla os Popups ---
        function proximaEtapa(idDoProximoPopup) {
            document.querySelectorAll('.help-popup').forEach(popup => {
                popup.style.display = 'none';
            });
            if (idDoProximoPopup) {
                document.getElementById(idDoProximoPopup).style.display = 'block';
            }
        }

        // --- L√ìGICA DO TUTORIAL ---

        // ETAPA 1: Clicar no Contato
        targetContato.addEventListener('click', function() {
            chatListScreen.style.transform = 'translateX(-100%)';
            chatScreen.style.transform = 'translateX(0)';
            proximaEtapa('popup-2');
        });

        // ETAPA 2: Clicar no Bot√£o de Ligar (telefone.png)
        targetCallButton.addEventListener('click', function() {
            chatScreen.style.transform = 'translateX(-100%)'; // Esconde a tela de chat
            callScreen.classList.add('active'); // CORRE√á√ÉO: Adiciona a classe 'active' para mostrar a tela de liga√ß√£o
            proximaEtapa('popup-3');

            // Simula a chamada sendo atendida
            let segundos = 0;
            let callInterval;

            const startCallTimer = () => {
                // Limpa o intervalo anterior, se houver
                if (callInterval) clearInterval(callInterval);
                
                callInterval = setInterval(() => {
                    segundos++;
                    const min = String(Math.floor(segundos / 60)).padStart(2, '0');
                    const sec = String(segundos % 60).padStart(2, '0');
                    callStatus.textContent = `${min}:${sec}`;
                }, 1000);
            };
            
            callStatus.textContent = 'Chamando...'; // Garante que come√ßa com "Chamando..."
            
            setTimeout(function() {
                callStatus.textContent = '00:00'; // Simula que atendeu
                startCallTimer(); // Inicia o contador
            }, 3000); // 3 segundos para a pessoa "atender"

            setTimeout(function() {
                // Se o popup 3 ainda estiver vis√≠vel, significa que o usu√°rio n√£o clicou "Entendi"
                // Ent√£o, mostramos o popup 4 para instruir a desligar.
                if(document.getElementById('popup-3').style.display !== 'none') {
                    proximaEtapa('popup-4');
                }
            }, 6000); // 6 segundos ap√≥s clicar para ligar
        });

        // ETAPA 3: Clicar em Desligar (Bot√£o Vermelho)
        targetEndCallButton.addEventListener('click', function() {
            // Limpa o contador da liga√ß√£o
            clearInterval(callInterval); 
            callStatus.textContent = 'Chamada finalizada';
            
            // Espera um pouco para mostrar "Chamada finalizada"
            setTimeout(function() {
                // Volta para a lista de conversas e esconde a tela de liga√ß√£o
                callScreen.classList.remove('active'); // CORRE√á√ÉO: Remove a classe 'active' para esconder
                chatListScreen.style.transform = 'translateX(0)';
                chatScreen.style.transform = 'translateX(100%)'; 
                
                proximaEtapa('popup-5');
                
                // Reseta o status para a pr√≥xima vez (para quando o tutorial for refeito)
                segundos = 0; // Reseta os segundos
                setTimeout(() => { callStatus.textContent = 'Chamando...'; }, 500);
            }, 1500);
        });

        // --- Bot√µes Extras ---
        // Volta da tela de chat para a lista
        backButton.addEventListener('click', function(e) {
            e.preventDefault();
            chatScreen.style.transform = 'translateX(100%)';
            chatListScreen.style.transform = 'translateX(0)';
            proximaEtapa('popup-1');
        });

        // Inicia o tutorial
        document.addEventListener('DOMContentLoaded', function() {
            proximaEtapa('popup-1');

            // Adiciona a funcionalidade de fechar em todos os bot√µes 'X'
            document.querySelectorAll('.popup-close').forEach(button => {
                button.addEventListener('click', function() {
                    this.parentElement.style.display = 'none';
                });
            });
        });
    </script>

</body>
</html>

